<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            background-color: #f1e4dc;
            font-family: 'Poppins', sans-serif;
        }
        .card {
            background-color: #fff;
            border: 1px solid #e8c89a;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        .home-link {
            color: #5c3a1d;
            text-decoration: none;
            padding: 10px 20px;
            margin-bottom: 24px;
            display: inline-block;
            border-radius: 6px;
            background-color: #fff8f0;
            border: 1px solid #e8c89a;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .home-link:hover {
            background-color: #f2cfb1;
        }
        .home-link i {
            margin-right: 8px;
        }
        .form-label {
            color: #5c3a1d;
            font-weight: 500;
        }
        .form-control, .form-select {
            border: 2px solid #e8c89a;
            border-radius: 8px;
            font-size: 14px;
            padding: 10px;
        }
        .form-control:focus, .form-select:focus {
            border-color: #5c3a1d;
            box-shadow: none;
        }
        .btn-primary.buttonCheckout {
            background-color: #5c3a1d;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .btn-primary.buttonCheckout:hover {
            background-color: #7a4f30;
        }
        .badge.bg-secondary {
            background-color: #a67c52;
        }
        .text-primary {
            color: #5c3a1d !important;
        }
    </style>
</head>
<body>
    
<div class="container py-5">
    <a href="../index.html" class="home-link">
        <i class="bi bi-arrow-left" ></i> Quay về trang chủ
    </a>
    
    <div class="row g-4">
        <!-- Left Column - Cart Items -->
        <div class="col-12 col-lg-8">
            <div class="card shadow">
                <div class="card-body">
                    <h2 class="h4 mb-4">Danh sách sản phẩm</h2>
                    <div class="list">
                        <!-- Products will be added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column - Order Form -->
        <div class="col-12 col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h2 class="h4 mb-4">Đơn hàng</h2>
                    <form class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="name" class="form-label">Họ và tên</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>

                        <div class="mb-3">
                            <label for="phone" class="form-label">Số điện thoại</label>
                            <input type="tel" class="form-control" id="phone" required>
                        </div>

                        <div class="mb-3">
                            <label for="address" class="form-label">Địa chỉ</label>
                            <input type="text" class="form-control" id="address" required>
                        </div>

                        <div class="mb-3">
                            <label for="country" class="form-label">Quốc gia</label>
                            <select class="form-select" id="country" required>
                                <option value="">Chọn...</option>
                                <option value="Vietnam">Việt Nam</option>
                                <option value="Kingdom">Kingdom</option>
                            </select>
                        </div>

                        <div class="mb-3" id="city-group" style="display: none;">
                            <label for="city" class="form-label">Tỉnh / Thành phố</label>
                            <select class="form-select" id="city" required>
                                <option value="">Chọn...</option>
                            </select>
                        </div>

                        <hr class="my-4">

                        <div class="d-flex justify-content-between mb-2">
                            <span>Tổng sản phẩm:</span>
                            <span class="totalQuantity fw-bold">0</span>
                        </div>
                        <div class="d-flex justify-content-between mb-4">
                            <span>Thành tiền:</span>
                            <span class="totalPrice fw-bold text-primary">0</span>
                        </div>

                        <button type="submit" class="btn btn-primary w-100 buttonCheckout">
                            Đặt hàng
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const countrySelect = document.getElementById("country");
    const citySelect = document.getElementById("city");
    const cityGroup = document.getElementById("city-group");

    // Danh sách tỉnh thành Việt Nam
    const vietnamCities = [
        "An Giang", "Bà Rịa - Vũng Tàu", "Bắc Giang", "Bắc Kạn", "Bạc Liêu", "Bắc Ninh",
        "Bến Tre", "Bình Định", "Bình Dương", "Bình Phước", "Bình Thuận", "Cà Mau",
        "Cần Thơ", "Cao Bằng", "Đà Nẵng", "Đắk Lắk", "Đắk Nông", "Điện Biên", "Đồng Nai",
        "Đồng Tháp", "Gia Lai", "Hà Giang", "Hà Nam", "Hà Nội", "Hà Tĩnh", "Hải Dương",
        "Hải Phòng", "Hậu Giang", "Hòa Bình", "Hưng Yên", "Khánh Hòa", "Kiên Giang",
        "Kon Tum", "Lai Châu", "Lâm Đồng", "Lạng Sơn", "Lào Cai", "Long An", "Nam Định",
        "Nghệ An", "Ninh Bình", "Ninh Thuận", "Phú Thọ", "Phú Yên", "Quảng Bình",
        "Quảng Nam", "Quảng Ngãi", "Quảng Ninh", "Quảng Trị", "Sóc Trăng", "Sơn La",
        "Tây Ninh", "Thái Bình", "Thái Nguyên", "Thanh Hóa", "Thừa Thiên Huế", "Tiền Giang",
        "TP. Hồ Chí Minh", "Trà Vinh", "Tuyên Quang", "Vĩnh Long", "Vĩnh Phúc", "Yên Bái"
    ];

    // Xử lý hiển thị tỉnh thành khi chọn quốc gia
    countrySelect.addEventListener("change", function() {
        const selectedCountry = this.value;
        citySelect.innerHTML = '<option value="">Chọn...</option>';

        if (selectedCountry === "Vietnam") {
            cityGroup.style.display = "block";
            vietnamCities.forEach(city => {
                const option = document.createElement("option");
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });
        } else {
            cityGroup.style.display = "none";
        }
    });

    // Lấy và hiển thị sản phẩm từ giỏ hàng
    const products = JSON.parse(localStorage.getItem('cartProducts')) || [];
    
    if (products.length > 0) {
        const listContainer = document.querySelector('.list');
        let totalQuantity = 0;
        let totalPrice = 0;

        products.forEach(function(product) {
            const price = parseInt(product.price.replace(/[^\d]/g, ''));
            const itemTotal = price * product.quantity;

            const item = document.createElement('div');
            item.classList.add('card', 'mb-3', 'border-0');
            item.innerHTML = `
                <div class="row g-0 align-items-center">
                    <div class="col-4 col-md-2">
                        <img src="${product.img}" class="img-fluid rounded" alt="${product.title}">
                    </div>
                    <div class="col-8 col-md-10">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-12 col-md-5">
                                    <h5 class="card-title">${product.title}</h5>
                                    <p class="card-text text-muted">${price.toLocaleString('vi-VN')} VNĐ / 1 sản phẩm</p>
                                </div>
                                <div class="col-6 col-md-3">
                                    <span class="badge bg-secondary">Số lượng: ${product.quantity}</span>
                                </div>
                                <div class="col-6 col-md-4 text-end">
                                    <span class="fw-bold">${itemTotal.toLocaleString('vi-VN')} VNĐ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            listContainer.appendChild(item);

            totalQuantity += parseInt(product.quantity);
            totalPrice += itemTotal;
        });

        document.querySelector('.totalQuantity').innerText = totalQuantity;
        document.querySelector('.totalPrice').innerText = `${totalPrice.toLocaleString('vi-VN')} VNĐ`;
    }

    // Form validation và xử lý đặt hàng
    document.querySelector('form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const country = document.getElementById('country').value;
        const city = document.getElementById('city').value;

        if (name && phone && address && country && (country !== 'Vietnam' || city)) {
            localStorage.removeItem('cartProducts');
            window.location.href = 'pay.html';
        } else {
            alert("Vui lòng điền đầy đủ thông tin!");
        }
    });
    
</script>
<!-- <script src="../assets/js/checkout.js"></script> -->
</body>
</html>
